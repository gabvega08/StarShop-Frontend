#!/bin/sh
# Pre-push hook - runs all validations before pushing
echo "ğŸ” Running pre-push validations..."

# Run lint-staged first
echo "ğŸ“ Running lint-staged..."
npx lint-staged --no-stash
if [ $? -ne 0 ]; then
    echo "âš ï¸  Lint issues found. Attempting to auto-fix..."
    npm run lint:fix
    npm run format
    echo "ğŸ”„ Re-running lint-staged after auto-fix..."
    npx lint-staged --no-stash
    if [ $? -ne 0 ]; then
        echo "âŒ Lint issues could not be auto-fixed. Please fix manually."
        exit 1
    fi
fi

# Run build
echo "ğŸ—ï¸  Running build..."
npm run build
if [ $? -ne 0 ]; then
    echo "âŒ Build failed. Please fix the issues before pushing."
    exit 1
fi

echo "âœ… All pre-push validations passed!"
